var mail=function(){var _g={load:load,load_content:get_pjax_content,link:v___location_prefix+'/mailbox/index.cgi?id=',path:{extensions:v___server_extensions_path,css:v___server_css_path,js:v___server_js_path},lang:{noRecords:theme_language('theme_xhred_datatable_szerorecords')}};var folders=function(){var strings={files:{fancytree:'jquery.fancytree'},selectors:{navigation:'aside .navigation',folders:'data-mail-folders'}};(function(){_g.load.bundle(_g.path.js+"/"+strings.files.fancytree,_g.path.css+"/"+strings.files.fancytree,[get],1);})();function get(key){key=key?'?key='+key:String();$.post(_g.path.extensions+"/mail/folders.cgi"+key+"",function(data){if(!!key){tree.reload(data);}else{tree.init(data);}});}function adjust(){tree.adjust();}var tree={container:'['+strings.selectors.folders+']',init:function init(data){var _this=this;$(strings.selectors.navigation).prepend('<div '+strings.selectors.folders+'></div>');$(this.container).fancytree({source:data,escapeTitles:false,autoActivate:false,autoScroll:true,keyboard:false,toggleEffect:false,init:function init(e,d){},activate:function activate(e,d){_this.adjust();_this.expand(d.node);_g.load_content(_g.link+d.node.key);}});$(this.container).mCustomScrollbar({axis:"xy",theme:"minimal",keyboard:false,scrollInertia:300,scrollButtons:true,autoHideScrollbar:false});},expand:function expand(node){var expanded=node.isExpanded();!expanded&&node.toggleExpanded();},reload:function reload(data){var _this2=this;var tree=$(this.container).fancytree("getTree");tree.$container.empty();tree.reload(data);setTimeout(function(){_this2.adjust();_this2.expand(_this2.get_active_node());},1e2);},adjust:function adjust(){var $_=this.get_active_node();if($_&&$_.li&&$($_.li).length){$(this.container).mCustomScrollbar("scrollTo",$($_.li),{scrollOffset:[$(this.container),3,4]});}},get_active_node:function get_active_node(){return $(this.container).fancytree("getActiveNode");}};return{get:get,adjust:adjust};}();return{folders:{get:folders.get,adjust:folders.adjust}};}();
