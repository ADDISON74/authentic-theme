(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("oz",function(E){function C(c){return new RegExp("^(("+c.join(")|(")+"))\\b")}var D=/[\^@!\|<>#~\.\*\-\+\\/,=]/;var L=/(<-)|(:=)|(=<)|(>=)|(<=)|(<:)|(>:)|(=:)|(\\=)|(\\=:)|(!!)|(==)|(::)/;var J=/(:::)|(\.\.\.)|(=<:)|(>=:)/;var v=["in","then","else","of","elseof","elsecase","elseif","catch","finally","with","require","prepare","import","export","define","do"];var H=["end"];var I=C(["true","false","nil","unit"]);var w=C(["andthen","at","attr","declare","feat","from","lex","mod","div","mode","orelse","parser","prod","prop","scanner","self","syn","token"]);var x=C(["local","proc","fun","case","class","if","cond","or","dis","choice","not","thread","try","raise","lock","for","suchthat","meth","functor"]);var A=C(v);var a=C(H);function u(c,d){if(c.eatSpace()){return null}if(c.match(/[{}]/)){return"bracket"}if(c.match(/(\[])/)){return"keyword"}if(c.match(J)||c.match(L)){return"operator"}if(c.match(I)){return"atom"}var f=c.match(x);if(f){if(!d.doInCurrentLine){d.currentIndent++}else{d.doInCurrentLine=false}if(f[0]=="proc"||f[0]=="fun"){d.tokenize=G}else{if(f[0]=="class"){d.tokenize=B}else{if(f[0]=="meth"){d.tokenize=K}}}return"keyword"}if(c.match(A)||c.match(w)){return"keyword"}if(c.match(a)){d.currentIndent--;return"keyword"}var e=c.next();if(e=='"'||e=="'"){d.tokenize=F(e);return d.tokenize(c,d)}if(/[~\d]/.test(e)){if(e=="~"){if(!/^[0-9]/.test(c.peek())){return null}else{if((c.next()=="0"&&c.match(/^[xX][0-9a-fA-F]+/))||c.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}}}if((e=="0"&&c.match(/^[xX][0-9a-fA-F]+/))||c.match(/^[0-9]*(\.[0-9]+)?([eE][~+]?[0-9]+)?/)){return"number"}return null}if(e=="%"){c.skipToEnd();return"comment"}else{if(e=="/"){if(c.eat("*")){d.tokenize=y;return y(c,d)}}}if(D.test(e)){return"operator"}c.eatWhile(/\w/);return"variable"}function B(c,d){if(c.eatSpace()){return null}c.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)/);d.tokenize=u;return"variable-3"}function K(c,d){if(c.eatSpace()){return null}c.match(/([a-zA-Z][A-Za-z0-9_]*)|(`.+`)/);d.tokenize=u;return"def"}function G(c,d){if(c.eatSpace()){return null}if(!d.hasPassedFirstStage&&c.eat("{")){d.hasPassedFirstStage=true;return"bracket"}else{if(d.hasPassedFirstStage){c.match(/([A-Z][A-Za-z0-9_]*)|(`.+`)|\$/);d.hasPassedFirstStage=false;d.tokenize=u;return"def"}else{d.tokenize=u;return null}}}function y(c,d){var f=false,e;while(e=c.next()){if(e=="/"&&f){d.tokenize=u;break}f=(e=="*")}return"comment"}function F(c){return function(g,d){var h=false,e,f=false;while((e=g.next())!=null){if(e==c&&!h){f=true;break}h=!h&&e=="\\"}if(f||!h){d.tokenize=u}return"string"}}function z(){var c=v.concat(H);return new RegExp("[\\[\\]]|("+c.join("|")+")$")}return{startState:function(){return{tokenize:u,currentIndent:0,doInCurrentLine:false,hasPassedFirstStage:false}},token:function(c,d){if(c.sol()){d.doInCurrentLine=0}return d.tokenize(c,d)},indent:function(c,e){var d=e.replace(/^\s+|\s+$/g,"");if(d.match(a)||d.match(A)||d.match(/(\[])/)){return E.indentUnit*(c.currentIndent-1)}if(c.currentIndent<0){return 0}return c.currentIndent*E.indentUnit},fold:"indent",electricInput:z(),lineComment:"%",blockCommentStart:"/*",blockCommentEnd:"*/"}});b.defineMIME("text/x-oz","oz")});