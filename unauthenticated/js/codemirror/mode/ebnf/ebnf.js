(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("ebnf",function(h){var a={slash:0,parenthesis:1};var f={comment:0,_string:1,characterClass:2};var g=null;if(h.bracesMode){g=b.getMode(h,h.bracesMode)}return{startState:function(){return{stringType:null,commentType:null,braced:0,lhs:true,localState:null,stack:[],inDefinition:false}},token:function(c,e){if(!c){return}if(e.stack.length===0){if((c.peek()=='"')||(c.peek()=="'")){e.stringType=c.peek();c.next();e.stack.unshift(f._string)}else{if(c.match(/^\/\*/)){e.stack.unshift(f.comment);e.commentType=a.slash}else{if(c.match(/^\(\*/)){e.stack.unshift(f.comment);e.commentType=a.parenthesis}}}}switch(e.stack[0]){case f._string:while(e.stack[0]===f._string&&!c.eol()){if(c.peek()===e.stringType){c.next();e.stack.shift()}else{if(c.peek()==="\\"){c.next();c.next()}else{c.match(/^.[^\\\"\']*/)}}}return e.lhs?"property string":"string";case f.comment:while(e.stack[0]===f.comment&&!c.eol()){if(e.commentType===a.slash&&c.match(/\*\//)){e.stack.shift();e.commentType=null}else{if(e.commentType===a.parenthesis&&c.match(/\*\)/)){e.stack.shift();e.commentType=null}else{c.match(/^.[^\*]*/)}}}return"comment";case f.characterClass:while(e.stack[0]===f.characterClass&&!c.eol()){if(!(c.match(/^[^\]\\]+/)||c.match(/^\\./))){e.stack.shift()}}return"operator"}var n=c.peek();if(g!==null&&(e.braced||n==="{")){if(e.localState===null){e.localState=b.startState(g)}var i=g.token(c,e.localState),d=c.current();if(!i){for(var m=0;m<d.length;m++){if(d[m]==="{"){if(e.braced===0){i="matchingbracket"}e.braced++}else{if(d[m]==="}"){e.braced--;if(e.braced===0){i="matchingbracket"}}}}}return i}switch(n){case"[":c.next();e.stack.unshift(f.characterClass);return"bracket";case":":case"|":case";":c.next();return"operator";case"%":if(c.match("%%")){return"header"}else{if(c.match(/[%][A-Za-z]+/)){return"keyword"}else{if(c.match(/[%][}]/)){return"matchingbracket"}}}break;case"/":if(c.match(/[\/][A-Za-z]+/)){return"keyword"}case"\\":if(c.match(/[\][a-z]+/)){return"string-2"}case".":if(c.match(".")){return"atom"}case"*":case"-":case"+":case"^":if(c.match(n)){return"atom"}case"$":if(c.match("$$")){return"builtin"}else{if(c.match(/[$][0-9]+/)){return"variable-3"}}case"<":if(c.match(/<<[a-zA-Z_]+>>/)){return"builtin"}}if(c.match(/^\/\//)){c.skipToEnd();return"comment"}else{if(c.match(/return/)){return"operator"}else{if(c.match(/^[a-zA-Z_][a-zA-Z0-9_]*/)){if(c.match(/(?=[\(.])/)){return"variable"}else{if(c.match(/(?=[\s\n]*[:=])/)){return"def"}}return"variable-2"}else{if(["[","]","(",")"].indexOf(c.peek())!=-1){c.next();return"bracket"}else{if(!c.eatSpace()){c.next()}}}}}return null}}});b.defineMIME("text/x-ebnf","ebnf")});