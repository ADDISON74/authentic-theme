(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("tiddlywiki",function(){var D={};var M={allTags:true,closeAll:true,list:true,newJournal:true,newTiddler:true,permaview:true,saveChanges:true,search:true,slider:true,tabs:true,tag:true,tagging:true,tags:true,tiddler:true,timeline:true,today:true,version:true,option:true,"with":true,filter:true};var B=/[\w_\-]/i,I=/^\-\-\-\-+$/,O=/^\/\*\*\*$/,T=/^\*\*\*\/$/,G=/^<<<$/,P=/^\/\/\{\{\{$/,E=/^\/\/\}\}\}$/,J=/^<!--\{\{\{-->$/,y=/^<!--\}\}\}-->$/,C=/^\{\{\{$/,L=/^\}\}\}$/,Q=/.*?\}\}\}/;function H(c,d,e){d.tokenize=e;return e(c,d)}function a(f,c){var d=f.sol(),e=f.peek();c.block=false;if(d&&/[<\/\*{}\-]/.test(e)){if(f.match(C)){c.block=true;return H(f,c,F)}if(f.match(G)){return"quote"}if(f.match(O)||f.match(T)){return"comment"}if(f.match(P)||f.match(E)||f.match(J)||f.match(y)){return"comment"}if(f.match(I)){return"hr"}}f.next();if(d&&/[\/\*!#;:>|]/.test(e)){if(e=="!"){f.skipToEnd();return"header"}if(e=="*"){f.eatWhile("*");return"comment"}if(e=="#"){f.eatWhile("#");return"comment"}if(e==";"){f.eatWhile(";");return"comment"}if(e==":"){f.eatWhile(":");return"comment"}if(e==">"){f.eatWhile(">");return"quote"}if(e=="|"){return"header"}}if(e=="{"&&f.match(/\{\{/)){return H(f,c,F)}if(/[hf]/i.test(e)&&/[ti]/i.test(f.peek())&&f.match(/\b(ttps?|tp|ile):\/\/[\-A-Z0-9+&@#\/%?=~_|$!:,.;]*[A-Z0-9+&@#\/%=~_|$]/i)){return"link"}if(e=='"'){return"string"}if(e=="~"){return"brace"}if(/[\[\]]/.test(e)&&f.match(e)){return"brace"}if(e=="@"){f.eatWhile(B);return"link"}if(/\d/.test(e)){f.eatWhile(/\d/);return"number"}if(e=="/"){if(f.eat("%")){return H(f,c,S)}else{if(f.eat("/")){return H(f,c,A)}}}if(e=="_"&&f.eat("_")){return H(f,c,R)}if(e=="-"&&f.eat("-")){if(f.peek()!=" "){return H(f,c,z)}if(f.peek()==" "){return"brace"}}if(e=="'"&&f.eat("'")){return H(f,c,N)}if(e=="<"&&f.eat("<")){return H(f,c,K)}f.eatWhile(/[\w\$_]/);return D.propertyIsEnumerable(f.current())?"keyword":null}function S(f,c){var e=false,d;while(d=f.next()){if(d=="/"&&e){c.tokenize=a;break}e=(d=="%")}return"comment"}function N(f,c){var e=false,d;while(d=f.next()){if(d=="'"&&e){c.tokenize=a;break}e=(d=="'")}return"strong"}function F(d,e){var c=e.block;if(c&&d.current()){return"comment"}if(!c&&d.match(Q)){e.tokenize=a;return"comment"}if(c&&d.sol()&&d.match(L)){e.tokenize=a;return"comment"}d.next();return"comment"}function A(f,c){var e=false,d;while(d=f.next()){if(d=="/"&&e){c.tokenize=a;break}e=(d=="/")}return"em"}function R(f,c){var e=false,d;while(d=f.next()){if(d=="_"&&e){c.tokenize=a;break}e=(d=="_")}return"underlined"}function z(f,c){var e=false,d;while(d=f.next()){if(d=="-"&&e){c.tokenize=a;break}e=(d=="-")}return"strikethrough"}function K(c,d){if(c.current()=="<<"){return"macro"}var e=c.next();if(!e){d.tokenize=a;return null}if(e==">"){if(c.peek()==">"){c.next();d.tokenize=a;return"macro"}}c.eatWhile(/[\w\$_]/);return M.propertyIsEnumerable(c.current())?"keyword":null}return{startState:function(){return{tokenize:a}},token:function(c,d){if(c.eatSpace()){return null}var e=d.tokenize(c,d);return e}}});b.defineMIME("text/x-tiddlywiki","tiddlywiki")});