(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"),require("../css/css"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../xml/xml","../javascript/javascript","../css/css"],b)}else{b(CodeMirror)}}})(function(o){var l={script:[["lang",/(javascript|babel)/i,"javascript"],["type",/^(?:text|application)\/(?:x-)?(?:java|ecma)script$|^module$|^$/i,"javascript"],["type",/./,"text/plain"],[null,null,"javascript"]],style:[["lang",/^css$/i,"css"],["type",/^(text\/)?(x-)?(stylesheet|css)$/i,"css"],["type",/./,"text/plain"],[null,null,"css"]]};function m(e,d,c){var a=e.current(),b=a.search(d);if(b>-1){e.backUp(a.length-b)}else{if(a.match(/<\/?$/)){e.backUp(a.length);if(!e.match(d,false)){e.match(a)}}}return c}var n={};function p(b){var a=n[b];if(a){return a}return n[b]=new RegExp("\\s+"+b+"\\s*=\\s*('|\")?([^'\"]+)('|\")?\\s*")}function r(a,c){var b=a.match(p(c));return b?/^\s*(.*?)\s*$/.exec(b[2])[1]:""}function j(a,b){return new RegExp((b?"^":"")+"</s*"+a+"s*>","i")}function k(e,f){for(var d in e){var c=f[d]||(f[d]=[]);var a=e[d];for(var b=a.length-1;b>=0;b--){c.unshift(a[b])}}}function q(b,a){for(var c=0;c<b.length;c++){var d=b[c];if(!d[0]||d[1].test(r(a,d[0]))){return d[2]}}}o.defineMode("htmlmixed",function(c,g){var e=o.getMode(c,{name:"xml",htmlMode:true,multilineTagIndentFactor:g.multilineTagIndentFactor,multilineTagIndentPastTag:g.multilineTagIndentPastTag});var d={};var f=g&&g.tags,h=g&&g.scriptTypes;k(l,d);if(f){k(f,d)}if(h){for(var a=h.length-1;a>=0;a--){d.script.unshift(["type",h[a].matches,h[a].mode])}}function b(C,i){var J=e.token(C,i.htmlState),B=/\btag\b/.test(J),H;if(B&&!/[<>\s\/]/.test(C.current())&&(H=i.htmlState.tagName&&i.htmlState.tagName.toLowerCase())&&d.hasOwnProperty(H)){i.inTag=H+" "}else{if(i.inTag&&B&&/>$/.test(C.current())){var I=/^([\S]+) (.*)/.exec(i.inTag);i.inTag=null;var D=C.current()==">"&&q(d[I[1]],I[2]);var E=o.getMode(c,D);var F=j(I[1],true),G=j(I[1],false);i.token=function(s,t){if(s.match(F,false)){t.token=b;t.localState=t.localMode=null;return null}return m(s,G,t.localMode.token(s,t.localState))};i.localMode=E;i.localState=o.startState(E,e.indent(i.htmlState,""))}else{if(i.inTag){i.inTag+=C.current();if(C.eol()){i.inTag+=" "}}}}return J}return{startState:function(){var i=o.startState(e);return{token:b,inTag:null,localMode:null,localState:null,htmlState:i}},copyState:function(i){var t;if(i.localState){t=o.copyState(i.localMode,i.localState)}return{token:i.token,inTag:i.inTag,localMode:i.localMode,localState:t,htmlState:o.copyState(e,i.htmlState)}},token:function(i,t){return t.token(i,t)},indent:function(i,u,v){if(!i.localMode||/^\s*<\//.test(u)){return e.indent(i.htmlState,u)}else{if(i.localMode.indent){return i.localMode.indent(i.localState,u,v)}else{return o.Pass}}},innerMode:function(i){return{state:i.localState||i.htmlState,mode:i.localMode||e}}}},"xml","javascript","css");o.defineMIME("text/html","htmlmixed")});