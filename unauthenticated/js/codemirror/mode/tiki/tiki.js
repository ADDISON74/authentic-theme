(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("tiki",function(x){function y(d,e,c){return function(g,f){while(!g.eol()){if(g.match(e)){f.tokenize=F;break}g.next()}if(c){f.tokenize=c}return d}}function G(c){return function(d,e){while(!d.eol()){d.next()}e.tokenize=F;return c}}function F(g,d){function c(h){d.tokenize=h;return h(g,d)}var e=g.sol();var f=g.next();switch(f){case"{":g.eat("/");g.eatSpace();g.eatWhile(/[^\s\u00a0=\"\'\/?(}]/);d.tokenize=a;return"tag";case"_":if(g.eat("_")){return c(y("strong","__",F))}break;case"'":if(g.eat("'")){return c(y("em","''",F))}break;case"(":if(g.eat("(")){return c(y("variable-2","))",F))}break;case"[":return c(y("variable-3","]",F));break;case"|":if(g.eat("|")){return c(y("comment","||"))}break;case"-":if(g.eat("=")){return c(y("header string","=-",F))}else{if(g.eat("-")){return c(y("error tw-deleted","--",F))}}break;case"=":if(g.match("==")){return c(y("tw-underline","===",F))}break;case":":if(g.eat(":")){return c(y("comment","::"))}break;case"^":return c(y("tw-box","^"));break;case"~":if(g.match("np~")){return c(y("meta","~/np~"))}break}if(e){switch(f){case"!":if(g.match("!!!!!")){return c(G("header string"))}else{if(g.match("!!!!")){return c(G("header string"))}else{if(g.match("!!!")){return c(G("header string"))}else{if(g.match("!!")){return c(G("header string"))}else{return c(G("header string"))}}}}break;case"*":case"#":case"+":return c(G("tw-listitem bracket"));break}}return null}var E=x.indentUnit;var R,M;function a(d,e){var f=d.next();var c=d.peek();if(f=="}"){e.tokenize=F;return"tag"}else{if(f=="("||f==")"){return"bracket"}else{if(f=="="){M="equals";if(c==">"){d.next();c=d.peek()}if(!/[\'\"]/.test(c)){e.tokenize=A()}return"operator"}else{if(/[\'\"]/.test(f)){e.tokenize=J(f);return e.tokenize(d,e)}else{d.eatWhile(/[^\s\u00a0=\"\'\/?]/);return"keyword"}}}}}function J(c){return function(d,e){while(!d.eol()){if(d.next()==c){e.tokenize=a;break}}return"string"}}function A(){return function(d,e){while(!d.eol()){var f=d.next();var c=d.peek();if(f==" "||f==","||/[ )}]/.test(c)){e.tokenize=a;break}}return"string"}}var I,L;function Q(){for(var c=arguments.length-1;c>=0;c--){I.cc.push(arguments[c])}}function O(){Q.apply(null,arguments);return true}function K(e,d){var c=I.context&&I.context.noIndent;I.context={prev:I.context,pluginName:e,indent:I.indented,startOfLine:d,noIndent:c}}function B(){if(I.context){I.context=I.context.prev}}function P(c){if(c=="openPlugin"){I.pluginName=R;return O(H,D(I.startOfLine))}else{if(c=="closePlugin"){var d=false;if(I.context){d=I.context.pluginName!=R;B()}else{d=true}if(d){L="error"}return O(N(d))}else{if(c=="string"){if(!I.context||I.context.name!="!cdata"){K("!cdata")}if(I.tokenize==F){B()}return O()}else{return O()}}}}function D(c){return function(d){if(d=="selfclosePlugin"||d=="endPlugin"){return O()}if(d=="endPlugin"){K(I.pluginName,c);return O()}return O()}}function N(c){return function(d){if(c){L="error"}if(d=="endPlugin"){return O()}return Q()}}function H(c){if(c=="keyword"){L="attribute";return O(H)}if(c=="equals"){return O(z,H)}return Q()}function z(c){if(c=="keyword"){L="string";return O()}if(c=="string"){return O(C)}return Q()}function C(c){if(c=="string"){return O(C)}else{return Q()}}return{startState:function(){return{tokenize:F,cc:[],indented:0,startOfLine:true,pluginName:null,context:null}},token:function(d,e){if(d.sol()){e.startOfLine=true;e.indented=d.indentation()}if(d.eatSpace()){return null}L=M=R=null;var f=e.tokenize(d,e);if((f||M)&&f!="comment"){I=e;while(true){var c=e.cc.pop()||P;if(c(M||f)){break}}}e.startOfLine=false;return L||f},indent:function(d,c){var e=d.context;if(e&&e.noIndent){return 0}if(e&&/^{\//.test(c)){e=e.prev}while(e&&!e.startOfLine){e=e.prev}if(e){return e.indent+E}else{return 0}},electricChars:"/"}});b.defineMIME("text/tiki","tiki")});