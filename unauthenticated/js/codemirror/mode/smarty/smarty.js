(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("smarty",function(E,s){var v=s.rightDelimiter||"}";var y=s.leftDelimiter||"{";var x=s.version||2;var B=b.getMode(E,s.baseMode||"null");var w=["debug","extends","function","include","literal"];var C={operatorChars:/[+\-*&%=<>!?]/,validIdentifier:/[a-zA-Z0-9_]/,stringChar:/['"]/};var t;function a(c,d){t=d;return c}function F(d,e,c){e.tokenize=c;return c(d,e)}function u(d,c){if(c==null){c=d.pos}return x===3&&y=="{"&&(c==d.string.length||/\s/.test(d.string.charAt(c)))}function z(c,d){var f=c.string;for(var g=c.pos;;){var h=f.indexOf(y,g);g=h+y.length;if(h==-1||!u(c,h+y.length)){break}}if(h==c.pos){c.match(y);if(c.eat("*")){return F(c,d,D("comment","*"+v))}else{d.depth++;d.tokenize=r;t="startTag";return"tag"}}if(h>-1){c.string=f.slice(0,h)}var e=B.token(c,d.base);if(h>-1){c.string=f}return e}function r(d,f){if(d.match(v,true)){if(x===3){f.depth--;if(f.depth<=0){f.tokenize=z}}else{f.tokenize=z}return a("tag",null)}if(d.match(y,true)){f.depth++;return a("tag","startTag")}var g=d.next();if(g=="$"){d.eatWhile(C.validIdentifier);return a("variable-2","variable")}else{if(g=="|"){return a("operator","pipe")}else{if(g=="."){return a("operator","property")}else{if(C.stringChar.test(g)){f.tokenize=A(g);return a("string","string")}else{if(C.operatorChars.test(g)){d.eatWhile(C.operatorChars);return a("operator","operator")}else{if(g=="["||g=="]"){return a("bracket","bracket")}else{if(g=="("||g==")"){return a("bracket","operator")}else{if(/\d/.test(g)){d.eatWhile(/\d/);return a("number","number")}else{if(f.last=="variable"){if(g=="@"){d.eatWhile(C.validIdentifier);return a("property","property")}else{if(g=="|"){d.eatWhile(C.validIdentifier);return a("qualifier","modifier")}}}else{if(f.last=="pipe"){d.eatWhile(C.validIdentifier);return a("qualifier","modifier")}else{if(f.last=="whitespace"){d.eatWhile(C.validIdentifier);return a("attribute","modifier")}}}if(f.last=="property"){d.eatWhile(C.validIdentifier);return a("property",null)}else{if(/\s/.test(g)){t="whitespace";return null}}var e="";if(g!="/"){e+=g}var c=null;while(c=d.eat(C.validIdentifier)){e+=c}for(var h=0,i=w.length;h<i;h++){if(w[h]==e){return a("keyword","keyword")}}if(/\s/.test(g)){return null}return a("tag","tag")}}}}}}}}}function A(c){return function(e,g){var d=null;var f=null;while(!e.eol()){f=e.peek();if(e.next()==c&&d!=="\\"){g.tokenize=r;break}d=f}return"string"}}function D(c,d){return function(e,f){while(!e.eol()){if(e.match(d)){f.tokenize=z;break}e.next()}return c}}return{startState:function(){return{base:b.startState(B),tokenize:z,last:null,depth:0}},copyState:function(c){return{base:b.copyState(B,c.base),tokenize:c.tokenize,last:c.last,depth:c.depth}},innerMode:function(c){if(c.tokenize==z){return{mode:B,state:c.base}}},token:function(c,d){var e=d.tokenize(c,d);d.last=t;return e},indent:function(d,c){if(d.tokenize==z&&B.indent){return B.indent(d.base,c)}else{return b.Pass}},blockCommentStart:y+"*",blockCommentEnd:"*"+v}});b.defineMIME("text/x-smarty","smarty")});