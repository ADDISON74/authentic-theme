(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"),require("../xml/xml"),require("../javascript/javascript"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../xml/xml","../javascript/javascript"],b)}else{b(CodeMirror)}}})(function(d){function e(c,a,b,h){this.state=c;this.mode=a;this.depth=b;this.prev=h}function f(a){return new e(d.copyState(a.mode,a.state),a.mode,a.depth,a.prev&&f(a.prev))}d.defineMode("jsx",function(n,b){var l=d.getMode(n,{name:"xml",allowMissing:true,multilineTagIndentPastTag:false});var c=d.getMode(n,b&&b.base||"javascript");function p(i){var g=i.tagName;i.tagName=null;var h=l.indent(i,"");i.tagName=g;return h}function m(g,h){if(h.context.mode==l){return o(g,h,h.context)}else{return a(g,h,h.context)}}function o(i,k,g){if(g.depth==2){if(i.match(/^.*?\*\//)){g.depth=1}else{i.skipToEnd()}return"comment"}if(i.peek()=="{"){l.skipAttribute(g.state);var h=p(g.state),t=g.state.context;if(t&&i.match(/^[^>]*>\s*$/,false)){while(t.prev&&!t.startOfLine){t=t.prev}if(t.startOfLine){h-=n.indentUnit}else{if(g.prev.state.lexical){h=g.prev.state.lexical.indented}}}else{if(g.depth==1){h+=n.indentUnit}}k.context=new e(d.startState(c,h),c,0,k.context);return null}if(g.depth==1){if(i.peek()=="<"){l.skipAttribute(g.state);k.context=new e(d.startState(l,p(g.state)),l,0,k.context);return null}else{if(i.match("//")){i.skipToEnd();return"comment"}else{if(i.match("/*")){g.depth=2;return m(i,k)}}}}var u=l.token(i,g.state),j=i.current(),v;if(/\btag\b/.test(u)){if(/>$/.test(j)){if(g.state.context){g.depth=0}else{k.context=k.context.prev}}else{if(/^</.test(j)){g.depth=1}}}else{if(!u&&(v=j.indexOf("{"))>-1){i.backUp(j.length-v)}}return u}function a(i,k,h){if(i.peek()=="<"&&c.expressionAllowed(i,h.state)){c.skipExpression(h.state);k.context=new e(d.startState(l,c.indent(h.state,"")),l,0,k.context);return null}var g=c.token(i,h.state);if(!g&&h.depth!=null){var j=i.current();if(j=="{"){h.depth++}else{if(j=="}"){if(--h.depth==0){k.context=k.context.prev}}}}return g}return{startState:function(){return{context:new e(d.startState(c),c)}},copyState:function(g){return{context:f(g.context)}},token:m,indent:function(i,h,g){return i.context.mode.indent(i.context.state,h,g)},innerMode:function(g){return g.context}}},"xml","javascript");d.defineMIME("text/jsx","jsx");d.defineMIME("text/typescript-jsx",{name:"jsx",base:{name:"javascript",typescript:true}})});