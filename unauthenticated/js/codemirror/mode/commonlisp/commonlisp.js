(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("commonlisp",function(s){var n=/^(block|let*|return-from|catch|load-time-value|setq|eval-when|locally|symbol-macrolet|flet|macrolet|tagbody|function|multiple-value-call|the|go|multiple-value-prog1|throw|if|progn|unwind-protect|labels|progv|let|quote)$/;var a=/^with|^def|^do|^prog|case$|^cond$|bind$|when$|unless$/;var o=/^(?:[+\-]?(?:\d+|\d*\.\d+)(?:[efd][+\-]?\d+)?|[+\-]?\d+(?:\/[+\-]?\d+)?|#b[+\-]?[01]+|#o[+\-]?[0-7]+|#x[+\-]?[\da-f]+)/;var r=/[^\s'`,@()\[\]";]/;var m;function p(c){var d;while(d=c.next()){if(d=="\\"){c.next()}else{if(!r.test(d)){c.backUp(1);break}}}return c.current()}function t(e,f){if(e.eatSpace()){m="ws";return null}if(e.match(o)){return"number"}var c=e.next();if(c=="\\"){c=e.next()}if(c=='"'){return(f.tokenize=q)(e,f)}else{if(c=="("){m="open";return"bracket"}else{if(c==")"||c=="]"){m="close";return"bracket"}else{if(c==";"){e.skipToEnd();m="ws";return"comment"}else{if(/['`,@]/.test(c)){return null}else{if(c=="|"){if(e.skipTo("|")){e.next();return"symbol"}else{e.skipToEnd();return"error"}}else{if(c=="#"){var c=e.next();if(c=="("){m="open";return"bracket"}else{if(/[+\-=\.']/.test(c)){return null}else{if(/\d/.test(c)&&e.match(/^\d*#/)){return null}else{if(c=="|"){return(f.tokenize=l)(e,f)}else{if(c==":"){p(e);return"meta"}else{if(c=="\\"){e.next();p(e);return"string-2"}else{return"error"}}}}}}}else{var d=p(e);if(d=="."){return null}m="symbol";if(d=="nil"||d=="t"||d.charAt(0)==":"){return"atom"}if(f.lastType=="open"&&(n.test(d)||a.test(d))){return"keyword"}if(d.charAt(0)=="&"){return"variable-2"}return"variable"}}}}}}}}function q(e,c){var f=false,d;while(d=e.next()){if(d=='"'&&!f){c.tokenize=t;break}f=!f&&d=="\\"}return"string"}function l(e,f){var d,c;while(d=e.next()){if(d=="#"&&c=="|"){f.tokenize=t;break}c=d}m="ws";return"comment"}return{startState:function(){return{ctx:{prev:null,start:0,indentTo:0},lastType:null,tokenize:t}},token:function(e,c){if(e.sol()&&typeof c.ctx.indentTo!="number"){c.ctx.indentTo=c.ctx.start+1}m=null;var d=c.tokenize(e,c);if(m!="ws"){if(c.ctx.indentTo==null){if(m=="symbol"&&a.test(e.current())){c.ctx.indentTo=c.ctx.start+s.indentUnit}else{c.ctx.indentTo="next"}}else{if(c.ctx.indentTo=="next"){c.ctx.indentTo=e.column()}}c.lastType=m}if(m=="open"){c.ctx={prev:c.ctx,start:e.column(),indentTo:null}}else{if(m=="close"){c.ctx=c.ctx.prev||c.ctx}}return d},indent:function(e,d){var c=e.ctx.indentTo;return typeof c=="number"?c:e.ctx.start+1},closeBrackets:{pairs:'()[]{}""'},lineComment:";;",blockCommentStart:"#|",blockCommentEnd:"|#"}});b.defineMIME("text/x-common-lisp","commonlisp")});