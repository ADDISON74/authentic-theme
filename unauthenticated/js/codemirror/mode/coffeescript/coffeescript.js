(function(b){if(typeof exports=="object"&&typeof module=="object"){b(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],b)}else{b(CodeMirror)}}})(function(b){b.defineMode("coffeescript",function(K,A){var T="error";function G(c){return new RegExp("^(("+c.join(")|(")+"))\\b")}var E=/^(?:->|=>|\+[+=]?|-[\-=]?|\*[\*=]?|\/[\/=]?|[=!]=|<[><]?=?|>>?=?|%=?|&=?|\|=?|\^=?|\~|!|\?|(or|and|\|\||&&|\?)=)/;var O=/^(?:[()\[\]{},:`=;]|\.\.?\.?)/;var N=/^[_A-Za-z$][_A-Za-z$0-9]*/;var B=/^@[_A-Za-z$][_A-Za-z$0-9]*/;var R=G(["and","or","not","is","isnt","in","instanceof","typeof"]);var S=["for","while","loop","if","unless","else","switch","try","catch","finally","class"];var D=["break","by","continue","debugger","delete","do","in","of","new","return","then","this","@","throw","when","until","extends"];var L=G(S.concat(D));S=G(S);var J=/^('{3}|\"{3}|['\"])/;var M=/^(\/{3}|\/)/;var I=["Infinity","NaN","undefined","null","true","false","on","off","yes","no"];var y=G(I);function a(d,e){if(d.sol()){if(e.scope.align===null){e.scope.align=false}var g=e.scope.offset;if(d.eatSpace()){var i=d.indentation();if(i>g&&e.scope.type=="coffee"){return"indent"}else{if(i<g){return"dedent"}}return null}else{if(g>0){Q(d,e)}}}if(d.eatSpace()){return null}var f=d.peek();if(d.match("####")){d.skipToEnd();return"comment"}if(d.match("###")){e.tokenize=F;return e.tokenize(d,e)}if(f==="#"){d.skipToEnd();return"comment"}if(d.match(/^-?[0-9\.]/,false)){var c=false;if(d.match(/^-?\d*\.\d+(e[\+\-]?\d+)?/i)){c=true}if(d.match(/^-?\d+\.\d*/)){c=true}if(d.match(/^-?\.\d+/)){c=true}if(c){if(d.peek()=="."){d.backUp(1)}return"number"}var h=false;if(d.match(/^-?0x[0-9a-f]+/i)){h=true}if(d.match(/^-?[1-9]\d*(e[\+\-]?\d+)?/)){h=true}if(d.match(/^-?0(?![\dx])/i)){h=true}if(h){return"number"}}if(d.match(J)){e.tokenize=C(d.current(),false,"string");return e.tokenize(d,e)}if(d.match(M)){if(d.current()!="/"||d.match(/^.*\//,false)){e.tokenize=C(d.current(),true,"string-2");return e.tokenize(d,e)}else{d.backUp(1)}}if(d.match(E)||d.match(R)){return"operator"}if(d.match(O)){return"punctuation"}if(d.match(y)){return"atom"}if(d.match(B)||e.prop&&d.match(N)){return"property"}if(d.match(L)){return"keyword"}if(d.match(N)){return"variable"}d.next();return T}function C(e,d,c){return function(f,g){while(!f.eol()){f.eatWhile(/[^'"\/\\]/);if(f.eat("\\")){f.next();if(d&&f.eol()){return c}}else{if(f.match(e)){g.tokenize=a;return c}else{f.eat(/['"\/]/)}}}if(d){if(A.singleLineStringErrors){c=T}else{g.tokenize=a}}return c}}function F(c,d){while(!c.eol()){c.eatWhile(/[^#]/);if(c.match("###")){d.tokenize=a;break}c.eatWhile("#")}return"comment"}function H(e,i,c){c=c||"coffee";var g=0,d=false,h=null;for(var f=i.scope;f;f=f.prev){if(f.type==="coffee"||f.type=="}"){g=f.offset+K.indentUnit;break}}if(c!=="coffee"){d=null;h=e.column()+e.current().length}else{if(i.scope.align){i.scope.align=false}}i.scope={offset:g,type:c,prev:i.scope,align:d,alignOffset:h}}function Q(e,g){if(!g.scope.prev){return}if(g.scope.type==="coffee"){var d=e.indentation();var f=false;for(var c=g.scope;c;c=c.prev){if(d===c.offset){f=true;break}}if(!f){return true}while(g.scope.prev&&g.scope.offset!==d){g.scope=g.scope.prev}return false}else{g.scope=g.scope.prev;return false}}function z(e,c){var d=c.tokenize(e,c);var g=e.current();if(g==="return"){c.dedent=true}if(((g==="->"||g==="=>")&&e.eol())||d==="indent"){H(e,c)}var f="[({".indexOf(g);if(f!==-1){H(e,c,"])}".slice(f,f+1))}if(S.exec(g)){H(e,c)}if(g=="then"){Q(e,c)}if(d==="dedent"){if(Q(e,c)){return T}}f="])}".indexOf(g);if(f!==-1){while(c.scope.type=="coffee"&&c.scope.prev){c.scope=c.scope.prev}if(c.scope.type==g){c.scope=c.scope.prev}}if(c.dedent&&e.eol()){if(c.scope.type=="coffee"&&c.scope.prev){c.scope=c.scope.prev}c.dedent=false}return d}var P={startState:function(c){return{tokenize:a,scope:{offset:c||0,type:"coffee",prev:null,align:false},prop:false,dedent:0}},token:function(f,c){var d=c.scope.align===null&&c.scope;if(d&&f.sol()){d.align=false}var e=z(f,c);if(e&&e!="comment"){if(d){d.align=true}c.prop=e=="punctuation"&&f.current()=="."}return e},indent:function(e,g){if(e.tokenize!=a){return 0}var f=e.scope;var d=g&&"])}".indexOf(g.charAt(0))>-1;if(d){while(f.type=="coffee"&&f.prev){f=f.prev}}var c=d&&f.type===g.charAt(0);if(f.align){return f.alignOffset-(c?1:0)}else{return(c?f.prev:f).offset}},lineComment:"#",fold:"indent"};return P});b.defineMIME("text/x-coffeescript","coffeescript");b.defineMIME("text/coffeescript","coffeescript")});